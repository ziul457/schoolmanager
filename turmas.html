<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>SchoolManager - Turmas</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <div id="hdr"></div>
  <div class="container">
    <div class="grid cols-2">
      <div class="card">
        <h3 style="margin:0 0 10px">Cadastrar Turma</h3>
        <form id="turmaForm" class="grid cols-2">
          <div><label>Nome</label><input name="nome" required/></div>
          <div><label>Ano</label><input name="ano" type="number" required/></div>
          <div><label>Turno</label><select name="turno"><option>Manh√£</option><option>Tarde</option><option>Noite</option></select></div>
          <button class="btn" type="submit">Salvar</button>
        </form>
      </div>
      <div class="card">
        <h3 style="margin:0 0 10px">Turmas</h3>
        <table class="table" id="turmaTable"></table>
      </div>
    </div>
  </div>
  <script src="app.js"></script>
  <script>
    App.guard(['admin']); App.mountHeader();
    const table = document.getElementById('turmaTable');
    const form = document.getElementById('turmaForm');
    function draw(){
      const rows = App.turmas.list().map(t=>`
        <tr><td>${t.nome}</td><td>${t.ano}</td><td>${t.turno}</td>
        <td style="text-align:right"><button data-id="${t.id}" class="btn ghost del">Excluir</button></td></tr>`).join('');
      table.innerHTML = `<tr><th>Nome</th><th>Ano</th><th>Turno</th><th></th></tr>${rows}`;
      document.querySelectorAll('.del').forEach(b=>b.onclick=()=>{ App.turmas.remove(b.dataset.id); draw(); });
    }
    form.onsubmit=(e)=>{ e.preventDefault(); const d=new FormData(form); App.turmas.create(Object.fromEntries(d.entries())); form.reset(); draw(); };
    draw();
  </script>
</body>
</html>
